apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 99-master-ibm
spec:
  config:
    ignition:
      version: 2.2.0
    storage:
      files:
        - path: /usr/local/bin/powersmt
          overwrite: true
          mode: 0700
          filesystem: root
          contents:
            source: data:text/plain;charset=utf-8;base64,IyEvYmluL2Jhc2gKZXhwb3J0IFBBVEg9L3Jvb3QvLmxvY2FsL2Jpbjovcm9vdC9iaW46L3NiaW46L2JpbjovdXNyL2xvY2FsL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9zYmluOi91c3IvYmluCmV4cG9ydCBLVUJFQ09ORklHPS92YXIvbGliL2t1YmVsZXQva3ViZWNvbmZpZwpDT1JFUFM9JCgvYmluL2xzY3B1IHwgL2Jpbi9hd2sgLUY6ICcgJDEgfiAvXkNvcmVcKHNcKSBwZXIgc29ja2V0JC8ge3ByaW50ICQyfSd8L2JpIG4veGFyZ3MpClNPQ0tFVFM9JCgvYmluL2xzY3B1IHwgL2Jpbi9hd2sgLUY6ICcgJDEgfiAvXlNvY2tldFwoc1wpJC8ge3ByaW50ICQyfSd8L2Jpbi94YXJncykKbGV0IFRPVEFMQ09SRVM9JENPUkVQUyokU09DS0VUUwpNQVhUSFJFQURTPSQoL2Jpbi9sc2NwdSB8IC9iaW4vYXdrIC1GOiAnICQxIH4gL15DUFVcKHNcKSQvIHtwcmludCAkMn0nfC9iaW4veGFyZ3MpCmxldCBNQVhTTVQ9JE1BWFRIUkVBRFMvJFRPVEFMQ09SRVMKQ1VSUkVOVFNNVD0kKC9iaW4vbHNjcHUgfCAvYmluL2F3ayAtRjogJyAkMSB+IC9eVGhyZWFkXChzXCkkLyB7cHJpbnQgJDJ9J3wvYmluL3hhcmdzKQp3aGlsZSA6IGRvCklTTk9ERURFR1JBREVEPSQoL2Jpbi9vYyBnZXQgbm9kZSAkSE9TVE5BTUUgLW8geWFtbCB8L2Jpbi9ncmVwIG1hY2hpbmVjb25maWd1cmF0IGlvbi5vcGVuc2hpZnQuaW8vcmVhc29uIHwvYmluL2dyZXAgInVuZXhwZWN0ZWQgb24tZGlzayBzdGF0ZSB2YWxpZGF0aW5nIikKU01UTEFCRUw9JCgvYmluL29jIGdldCBub2RlICRIT1NUTkFNRSAtTCBTTVQgLS1uby1oZWFkZXJzIHwvYmluL2F3ayAne3ByaW50ICQ2fScgKQogIGlmIFtbIC1uICRTTVRMQUJFTCBdXQogICAgdGhlbgogICAgICBjYXNlICRTTVRMQUJFTCBpbgogICAgICAgIDEpIFRBUkdFVFNNVD0xCiAgICAgIDs7CiAgICAgICAgMikgVEFSR0VUU01UPTIKICAgICAgOzsKICAgICAgICA0KSBUQVJHRVRTTVQ9NAogICAgICA7OwogICAgICAgIDgpIFRBUkdFVFNNVD04CiAgICAgIDs7CiAgICAgICAgKikgVEFSR0VUU01UPSRDVVJSRU5UU01UIDsgZWNobyAiU01UIHZhbHVlIG11c3QgYmUgMSwgMiwgNCwgb3IgOCBhbmQgc21hbGxlciB0aGFuIE1heGltdW0gU01ULiIKICAgICAgOzsKZXNhYyBlbHNlCiAgICAgIFRBUkdFVFNNVD0kTUFYU01UCiAgZmkKICBpZiBbWyAtbiAkSVNOT0RFREVHUkFERUQgXV0KICAgIHRoZW4KICAgICAgdG91Y2ggL3J1bi9tYWNoaW5lLWNvbmZpZy1kYWVtb24tZm9yY2UKICBmaQpDVVJSRU5UU01UPSQoL2Jpbi9sc2NwdSB8IC9iaW4vYXdrIC1GOiAnICQxIH4gL15UaHJlYWRcKHNcKSBwZXIgY29yZSQvIHtwcmludCAkMiB9J3wvYmluL3hhcmdzKQogIGlmIFtbICRDVVJSRU5UU01UIC1uZSAkVEFSR0VUU01UIF1dCiAgICB0aGVuCiAgICAgIElOSVRPTlRIUkVBRD0wCiAgICAgIElOSVRPRkZUSFJFQUQ9JFRBUkdFVFNNVAogICAgICBpZiBbWyAkTUFYU01UIC1nZSAkVEFSR0VUU01UIF1dCiAgICAgICAgdGhlbgogICAgICAgICAgd2hpbGUgW1sgJElOSVRPTlRIUkVBRCAtbHQgJE1BWFRIUkVBRFMgXV0KICAgICAgICAgIGRvCiAgICAgICAgICAgIE9OVEhSRUFEPSRJTklUT05USFJFQUQKICAgICAgICAgICAgT0ZGVEhSRUFEPSRJTklUT0ZGVEhSRUFECiAgICAgICAgICAgIHdoaWxlIFtbICRPTlRIUkVBRCAtbHQgJE9GRlRIUkVBRCBdXQogICAgICAgICAgICBkbwogICAgICAgICAgICAgIC9iaW4vZWNobyAxID4gL3N5cy9kZXZpY2VzL3N5c3RlbS9jcHUvY3B1JE9OVEhSRUFEL29ubGluZQogICAgICAgICAgICAgIGxldCBPTlRIUkVBRD0kT05USFJFQUQrMQogICAgICAgICAgICBkb25lCiAgICAgICAgICAgIGxldCBJTklUT05USFJFQUQ9JElOSVRPTlRIUkVBRCskTUFYU01UCiAgICAgICAgICAgIHdoaWxlIFtbICRPRkZUSFJFQUQgLWx0ICRJTklUT05USFJFQUQgXV0KICAgICAgICAgICAgZG8KICAgICAgICAgICAgICAvYmluL2VjaG8gMCA+IC9zeXMvZGV2aWNlcy9zeXN0ZW0vY3B1L2NwdSRPRkZUSFJFQUQvb25saW5lCiAgICAgICAgICAgICAgbGV0IE9GRlRIUkVBRD0kT0ZGVEhSRUFEKzEKICAgICAgICAgICAgZG9uZQpsZXQgSU5JVE9GRlRIUkVBRD0kSU5JVE9GRlRIUkVBRCskTUFYU01UIGRvbmUKZWxzZQplY2hvICJUYXJnZXQgU01UIG11c3QgYmUgc21hbGxlciBvciBlcXVhbCB0aGFuIE1heGltdW0gU01UIHN1cHBvcnRlZCIKZmkgZmkKICAvYmluL3NsZWVwIDMwCmRvbmUK
        - path: /etc/systemd/system/powersmt.service
          overwrite: true
          mode: 0644
          filesystem: root
          contents:
            source: data:text/plain;charset=utf-8;base64,W1VuaXRdCkRlc2NyaXB0aW9uPVBPV0VSU01UCkFmdGVyPW5ldHdvcmstb25saW5lLnRhcmdldApbU2VydmljZV0KRXhlY1N0YXJ0PSIvdXNyL2xvY2FsL2Jpbi9wb3dlcnNtdCIKW0luc3RhbGxdCldhbnRlZEJ5PW11bHRpLXVzZXIudGFyZ2V0Cg==
    systemd:
      units:
        - name: powersmt.service
          enabled: true            
